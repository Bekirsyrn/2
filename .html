<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Turbo Strike JS - Football Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #222; font-family: 'Arial', sans-serif; }
        canvas { display: block; background: linear-gradient(to bottom, #1a472a, #2d5a27); }
        #ui { position: absolute; top: 20px; left: 20px; color: white; pointer-events: none; }
        .score-board { font-size: 24px; font-weight: bold; text-shadow: 2px 2px #000; }
        #msg { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); 
               color: yellow; font-size: 48px; font-weight: bold; display: none; text-shadow: 3px 3px #000; }
    </style>
</head>
<body>

<div id="ui">
    <div class="score-board">SKOR: <span id="score">0</span></div>
    <div style="font-size: 14px;">Topu sürükle ve fırlat! (Falso için kavisli çek)</div>
</div>
<div id="msg">GOOOOOL!</div>

<script>
    const { Engine, Render, Runner, World, Bodies, Body, Events, Vector } = Matter;

    // --- AYARLAR ---
    let score = 0;
    let isShooting = false;
    let startPos = { x: 0, y: 0 };
    let points = [];

    const engine = Engine.create();
    const render = Render.create({
        element: document.body,
        engine: engine,
        options: {
            width: window.innerWidth,
            height: window.innerHeight,
            wireframes: false,
            background: 'transparent'
        }
    });

    // --- DÜNYA OBJELERİ ---
    const ground = Bodies.rectangle(window.innerWidth/2, window.innerHeight + 25, window.innerWidth, 50, { isStatic: true });
    
    // Kale Direkleri
    const goalLeft = Bodies.rectangle(window.innerWidth/2 - 150, 150, 10, 200, { isStatic: true, render: { fillStyle: 'white' } });
    const goalRight = Bodies.rectangle(window.innerWidth/2 + 150, 150, 10, 200, { isStatic: true, render: { fillStyle: 'white' } });
    const goalTop = Bodies.rectangle(window.innerWidth/2, 50, 310, 10, { isStatic: true, render: { fillStyle: 'white' } });
    
    // Kaleci
    const goalie = Bodies.rectangle(window.innerWidth/2, 130, 40, 60, { 
        isStatic: true, 
        render: { fillStyle: '#e74c3c' } 
    });

    // Top
    let ball = createBall();

    World.add(engine.world, [ground, goalLeft, goalRight, goalTop, goalie, ball]);

    function createBall() {
        return Bodies.circle(window.innerWidth/2, window.innerHeight - 100, 20, {
            restitution: 0.8,
            friction: 0.05,
            render: { sprite: { texture: 'https://cdn-icons-png.flaticon.com/512/33/33736.png', xScale: 0.08, yScale: 0.08 } }
        });
    }

    // --- OYUN MANTIĞI ---
    
    // Kaleci Hareket Yapay Zekası
    Events.on(engine, 'beforeUpdate', () => {
        const time = engine.timing.timestamp;
        const moveX = Math.sin(time * 0.005) * 120;
        Body.setPosition(goalie, { x: window.innerWidth/2 + moveX, y: 130 });

        // Gol Kontrolü
        if (ball.position.y < 150 && ball.position.x > goalLeft.position.x && ball.position.x < goalRight.position.x) {
            if (!ball.isScored) {
                ball.isScored = true;
                score++;
                document.getElementById('score').innerText = score;
                showGoalMessage();
                setTimeout(resetBall, 2000);
            }
        }
    });

    function showGoalMessage() {
        const msg = document.getElementById('msg');
        msg.style.display = 'block';
        setTimeout(() => msg.style.display = 'none', 1500);
    }

    function resetBall() {
        World.remove(engine.world, ball);
        ball = createBall();
        World.add(engine.world, ball);
    }

    // --- KONTROLLER ---
    window.addEventListener('mousedown', (e) => {
        startPos = { x: e.clientX, y: e.clientY };
        points = [];
        isShooting = true;
    });

    window.addEventListener('mousemove', (e) => {
        if (isShooting) points.push({ x: e.clientX, y: e.clientY });
    });

    window.addEventListener('mouseup', (e) => {
        if (!isShooting) return;
        isShooting = false;

        const endPos = { x: e.clientX, y: e.clientY };
        const forceVec = Vector.sub(endPos, startPos);
        
        // Falso (Curve) Hesaplama
        const curve = (points[0]?.x - points[points.length-1]?.x) * 0.0005;

        Body.applyForce(ball, ball.position, { 
            x: forceVec.x * 0.0002 + curve, 
            y: forceVec.y * 0.0002 
        });
    });

    Render.run(render);
    const runner = Runner.create();
    Runner.run(runner, engine);

    window.addEventListener('resize', () => location.reload());
</script>
</body>
</html>
